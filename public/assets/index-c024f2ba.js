import{V as N,c as A,C as I,a as p,b as y,R as E,d as O,e as S,r as w,f as M,g as b,h as X,i as Y,j as C,p as T,G as a,B as P,k as j,M as R,l as $}from"./html-083cb0d0.js";function B(s){const e=s.getBoundingClientRect(),t=s.ownerDocument.defaultView;return{top:e.top+t.pageYOffset,left:e.left+t.pageXOffset}}function U(s){return s.getBoundingClientRect().width}function k(s){return s.getBoundingClientRect().height}var V=globalThis&&globalThis.__decorate||function(s,e,t,n){var o=arguments.length,i=o<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(i=(o<3?r(i):o>3?r(e,t,i):r(e,t))||i);return o>3&&i&&Object.defineProperty(e,t,i),i};class D extends N{get graph(){return this.options.graph}get boxClassName(){return this.prefixClassName(d.classNames.box)}get $boxes(){return A(this.container,this.boxClassName)}get handleOptions(){return this.options}constructor(e){super(),this.options=e,this.options.model&&(this.options.collection=this.options.model.collection),this.options.collection?this.collection=this.options.collection:(this.collection=new I([],{comparator:d.depthComparator}),this.options.collection=this.collection),this.boxCount=0,this.createContainer(),this.startListening()}startListening(){const e=this.graph,t=this.collection;this.delegateEvents({[`mousedown .${this.boxClassName}`]:"onSelectionBoxMouseDown",[`touchstart .${this.boxClassName}`]:"onSelectionBoxMouseDown"},!0),e.on("scale",this.onGraphTransformed,this),e.on("translate",this.onGraphTransformed,this),e.model.on("updated",this.onModelUpdated,this),t.on("added",this.onCellAdded,this),t.on("removed",this.onCellRemoved,this),t.on("reseted",this.onReseted,this),t.on("updated",this.onCollectionUpdated,this),t.on("node:change:position",this.onNodePositionChanged,this),t.on("cell:changed",this.onCellChanged,this)}stopListening(){const e=this.graph,t=this.collection;this.undelegateEvents(),e.off("scale",this.onGraphTransformed,this),e.off("translate",this.onGraphTransformed,this),e.model.off("updated",this.onModelUpdated,this),t.off("added",this.onCellAdded,this),t.off("removed",this.onCellRemoved,this),t.off("reseted",this.onReseted,this),t.off("updated",this.onCollectionUpdated,this),t.off("node:change:position",this.onNodePositionChanged,this),t.off("cell:changed",this.onCellChanged,this)}onRemove(){this.stopListening()}onGraphTransformed(){this.updateSelectionBoxes()}onCellChanged(){this.updateSelectionBoxes()}onNodePositionChanged({node:e,options:t}){const{showNodeSelectionBox:n,pointerEvents:o}=this.options,{ui:i,selection:r,translateBy:l,snapped:h}=t,c=(n!==!0||o&&this.getPointerEventsValue(o)==="none")&&!this.translating&&!r,f=i&&l&&e.id===l;if(c&&(f||h)){this.translating=!0;const u=e.position(),g=e.previous("position"),m=u.x-g.x,v=u.y-g.y;(m!==0||v!==0)&&this.translateSelectedNodes(m,v,e,t),this.translating=!1}}onModelUpdated({removed:e}){e&&e.length&&this.unselect(e)}isEmpty(){return this.length<=0}isSelected(e){return this.collection.has(e)}get length(){return this.collection.length}get cells(){return this.collection.toArray()}select(e,t={}){t.dryrun=!0;const n=this.filter(Array.isArray(e)?e:[e]);return this.collection.add(n,t),this}unselect(e,t={}){return t.dryrun=!0,this.collection.remove(Array.isArray(e)?e:[e],t),this}reset(e,t={}){if(e){if(t.batch){const c=this.filter(Array.isArray(e)?e:[e]);return this.collection.reset(c,Object.assign(Object.assign({},t),{ui:!0})),this}const n=this.cells,o=this.filter(Array.isArray(e)?e:[e]),i={},r={};n.forEach(c=>i[c.id]=c),o.forEach(c=>r[c.id]=c);const l=[],h=[];return o.forEach(c=>{i[c.id]||l.push(c)}),n.forEach(c=>{r[c.id]||h.push(c)}),h.length&&this.unselect(h,Object.assign(Object.assign({},t),{ui:!0})),l.length&&this.select(l,Object.assign(Object.assign({},t),{ui:!0})),h.length===0&&l.length===0&&this.updateContainer(),this}return this.clean(t)}clean(e={}){return this.length&&(e.batch===!1?this.unselect(this.cells,e):this.collection.reset([],Object.assign(Object.assign({},e),{ui:!0}))),this}setFilter(e){this.options.filter=e}setContent(e){this.options.content=e}startSelecting(e){e=this.normalizeEvent(e),this.clean();let t,n;const o=this.graph.container;if(e.offsetX!=null&&e.offsetY!=null&&o.contains(e.target))t=e.offsetX,n=e.offsetY;else{const i=B(o),r=o.scrollLeft,l=o.scrollTop;t=e.clientX-i.left+window.pageXOffset+r,n=e.clientY-i.top+window.pageYOffset+l}p(this.container,{top:n,left:t,width:1,height:1}),this.setEventData(e,{action:"selecting",clientX:e.clientX,clientY:e.clientY,offsetX:t,offsetY:n,scrollerX:0,scrollerY:0,moving:!1}),this.delegateDocumentEvents(d.documentEvents,e.data)}filter(e){const t=this.options.filter;return e.filter(n=>Array.isArray(t)?t.some(o=>typeof o=="string"?n.shape===o:n.id===o.id):typeof t=="function"?y(t,this.graph,n):!0)}stopSelecting(e){const t=this.graph,n=this.getEventData(e);switch(n.action){case"selecting":{let i=U(this.container),r=k(this.container);const l=B(this.container),h=t.pageToLocal(l.left,l.top),c=t.transform.getScale();i/=c.sx,r/=c.sy;const f=new E(h.x,h.y,i,r),u=this.getCellViewsInArea(f).map(g=>g.cell);this.reset(u,{batch:!0}),this.hideRubberband();break}case"translating":{const i=t.snapToGrid(e.clientX,e.clientY);if(!this.options.following){const r=n;this.updateSelectedNodesPosition({dx:r.clientX-r.originX,dy:r.clientY-r.originY})}this.graph.model.stopBatch("move-selection"),this.notifyBoxEvent("box:mouseup",e,i.x,i.y);break}default:{this.clean();break}}}onMouseUp(e){this.getEventData(e).action&&(this.stopSelecting(e),this.undelegateDocumentEvents())}onSelectionBoxMouseDown(e){this.options.following||e.stopPropagation();const t=this.normalizeEvent(e);this.options.movable&&this.startTranslating(t);const n=this.getCellViewFromElem(t.target);this.setEventData(t,{activeView:n});const o=this.graph.snapToGrid(t.clientX,t.clientY);this.notifyBoxEvent("box:mousedown",t,o.x,o.y),this.delegateDocumentEvents(d.documentEvents,t.data)}startTranslating(e){this.graph.model.startBatch("move-selection");const t=this.graph.snapToGrid(e.clientX,e.clientY);this.setEventData(e,{action:"translating",clientX:t.x,clientY:t.y,originX:t.x,originY:t.y})}getRestrictArea(){const e=this.graph.options.translating.restrict,t=typeof e=="function"?y(e,this.graph,null):e;return typeof t=="number"?this.graph.transform.getGraphArea().inflate(t):t===!0?this.graph.transform.getGraphArea():t||null}getSelectionOffset(e,t){let n=e.x-t.clientX,o=e.y-t.clientY;const i=this.getRestrictArea();if(i){const r=this.collection.toArray(),l=O.getCellsBBox(r,{deep:!0})||E.create(),h=i.x-l.x,c=i.y-l.y,f=i.x+i.width-(l.x+l.width),u=i.y+i.height-(l.y+l.height);if(n<h&&(n=h),o<c&&(o=c),f<n&&(n=f),u<o&&(o=u),!this.options.following){const g=e.x-t.originX,m=e.y-t.originY;n=g<=h||g>=f?0:n,o=m<=c||m>=u?0:o}}return{dx:n,dy:o}}updateElementPosition(e,t,n){const o=p(e,"left"),i=p(e,"top"),r=o?parseFloat(o):0,l=i?parseFloat(i):0;p(e,"left",r+t),p(e,"top",l+n)}updateSelectedNodesPosition(e){const{dx:t,dy:n}=e;if(t||n)if(this.translateSelectedNodes(t,n),this.boxesUpdated)this.collection.length>1&&this.updateSelectionBoxes();else{const o=this.graph.transform.getScale();for(let i=0,r=this.$boxes,l=r.length;i<l;i+=1)this.updateElementPosition(r[i],t*o.sx,n*o.sy);this.updateElementPosition(this.selectionContainer,t*o.sx,n*o.sy)}}autoScrollGraph(e,t){const n=this.graph.getPlugin("scroller");return n?n.autoScroll(e,t):{scrollerX:0,scrollerY:0}}adjustSelection(e){const t=this.normalizeEvent(e),n=this.getEventData(t);switch(n.action){case"selecting":{const i=n;i.moving!==!0&&(S(this.container,this.graph.container),this.showRubberband(),i.moving=!0);const{scrollerX:r,scrollerY:l}=this.autoScrollGraph(t.clientX,t.clientY);i.scrollerX+=r,i.scrollerY+=l;const h=t.clientX-i.clientX+i.scrollerX,c=t.clientY-i.clientY+i.scrollerY,f=parseInt(p(this.container,"left")||"0",10),u=parseInt(p(this.container,"top")||"0",10);p(this.container,{left:h<0?i.offsetX+h:f,top:c<0?i.offsetY+c:u,width:Math.abs(h),height:Math.abs(c)});break}case"translating":{const i=this.graph.snapToGrid(t.clientX,t.clientY),r=n,l=this.getSelectionOffset(i,r);this.options.following?this.updateSelectedNodesPosition(l):this.updateContainerPosition(l),l.dx&&(r.clientX=i.x),l.dy&&(r.clientY=i.y),this.notifyBoxEvent("box:mousemove",e,i.x,i.y);break}}this.boxesUpdated=!1}translateSelectedNodes(e,t,n,o){const i={},r=[];if(n&&(i[n.id]=!0),this.collection.toArray().forEach(l=>{l.getDescendants({deep:!0}).forEach(h=>{i[h.id]=!0})}),o&&o.translateBy){const l=this.graph.getCellById(o.translateBy);l&&(i[l.id]=!0,l.getDescendants({deep:!0}).forEach(h=>{i[h.id]=!0}),r.push(l))}this.collection.toArray().forEach(l=>{if(!i[l.id]){const h=Object.assign(Object.assign({},o),{selection:this.cid,exclude:r});l.translate(e,t,h),this.graph.model.getConnectedEdges(l).forEach(c=>{i[c.id]||(c.translate(e,t,h),i[c.id]=!0)})}})}getCellViewsInArea(e){const t=this.graph,n={strict:this.options.strict};let o=[];return this.options.rubberNode&&(o=o.concat(t.model.getNodesInArea(e,n).map(i=>t.renderer.findViewByCell(i)).filter(i=>i!=null))),this.options.rubberEdge&&(o=o.concat(t.model.getEdgesInArea(e,n).map(i=>t.renderer.findViewByCell(i)).filter(i=>i!=null))),o}notifyBoxEvent(e,t,n,o){const r=this.getEventData(t).activeView;this.trigger(e,{e:t,view:r,x:n,y:o,cell:r.cell})}getSelectedClassName(e){return this.prefixClassName(`${e.isNode()?"node":"edge"}-selected`)}addCellSelectedClassName(e){const t=this.graph.renderer.findViewByCell(e);t&&t.addClass(this.getSelectedClassName(e))}removeCellUnSelectedClassName(e){const t=this.graph.renderer.findViewByCell(e);t&&t.removeClass(this.getSelectedClassName(e))}destroySelectionBox(e){this.removeCellUnSelectedClassName(e),this.canShowSelectionBox(e)&&(w(this.container.querySelector(`[data-cell-id="${e.id}"]`)),this.$boxes.length===0&&this.hide(),this.boxCount=Math.max(0,this.boxCount-1))}destroyAllSelectionBoxes(e){e.forEach(t=>this.removeCellUnSelectedClassName(t)),this.hide(),w(this.$boxes),this.boxCount=0}hide(){M(this.container,this.prefixClassName(d.classNames.rubberband)),M(this.container,this.prefixClassName(d.classNames.selected))}showRubberband(){b(this.container,this.prefixClassName(d.classNames.rubberband))}hideRubberband(){M(this.container,this.prefixClassName(d.classNames.rubberband))}showSelected(){X(this.container,"style"),b(this.container,this.prefixClassName(d.classNames.selected))}createContainer(){this.container=document.createElement("div"),b(this.container,this.prefixClassName(d.classNames.root)),this.options.className&&b(this.container,this.options.className),this.selectionContainer=document.createElement("div"),b(this.selectionContainer,this.prefixClassName(d.classNames.inner)),this.selectionContent=document.createElement("div"),b(this.selectionContent,this.prefixClassName(d.classNames.content)),Y(this.selectionContainer,this.selectionContent),C(this.selectionContainer,"data-selection-length",this.collection.length),T(this.container,this.selectionContainer)}updateContainerPosition(e){(e.dx||e.dy)&&this.updateElementPosition(this.selectionContainer,e.dx,e.dy)}updateContainer(){const e={x:1/0,y:1/0},t={x:0,y:0};this.collection.toArray().filter(i=>this.canShowSelectionBox(i)).forEach(i=>{const r=this.graph.renderer.findViewByCell(i);if(r){const l=r.getBBox({useCellGeometry:!0});e.x=Math.min(e.x,l.x),e.y=Math.min(e.y,l.y),t.x=Math.max(t.x,l.x+l.width),t.y=Math.max(t.y,l.y+l.height)}}),p(this.selectionContainer,{position:"absolute",pointerEvents:"none",left:e.x,top:e.y,width:t.x-e.x,height:t.y-e.y}),C(this.selectionContainer,"data-selection-length",this.collection.length);const o=this.options.content;if(o)if(typeof o=="function"){const i=y(o,this.graph,this,this.selectionContent);i&&(this.selectionContent.innerHTML=i)}else this.selectionContent.innerHTML=o;this.collection.length>0&&!this.container.parentNode?S(this.container,this.graph.container):this.collection.length<=0&&this.container.parentNode&&this.container.parentNode.removeChild(this.container)}canShowSelectionBox(e){return e.isNode()&&this.options.showNodeSelectionBox===!0||e.isEdge()&&this.options.showEdgeSelectionBox===!0}getPointerEventsValue(e){return typeof e=="string"?e:e(this.cells)}createSelectionBox(e){if(this.addCellSelectedClassName(e),this.canShowSelectionBox(e)){const t=this.graph.renderer.findViewByCell(e);if(t){const n=t.getBBox({useCellGeometry:!0}),o=this.boxClassName,i=document.createElement("div"),r=this.options.pointerEvents;b(i,o),b(i,`${o}-${e.isNode()?"node":"edge"}`),C(i,"data-cell-id",e.id),p(i,{position:"absolute",left:n.x,top:n.y,width:n.width,height:n.height,pointerEvents:r?this.getPointerEventsValue(r):"auto"}),S(i,this.container),this.showSelected(),this.boxCount+=1}}}updateSelectionBoxes(){this.collection.length>0&&(this.boxesUpdated=!0,this.confirmUpdate())}confirmUpdate(){if(this.boxCount){this.hide();for(let e=0,t=this.$boxes,n=t.length;e<n;e+=1){const o=t[e],i=C(o,"data-cell-id");w(o),this.boxCount-=1;const r=this.collection.get(i);r&&this.createSelectionBox(r)}this.updateContainer()}return 0}getCellViewFromElem(e){const t=e.getAttribute("data-cell-id");if(t){const n=this.collection.get(t);if(n)return this.graph.renderer.findViewByCell(n)}return null}onCellRemoved({cell:e}){this.destroySelectionBox(e),this.updateContainer()}onReseted({previous:e,current:t}){this.destroyAllSelectionBoxes(e),t.forEach(n=>{this.listenCellRemoveEvent(n),this.createSelectionBox(n)}),this.updateContainer()}onCellAdded({cell:e}){this.listenCellRemoveEvent(e),this.createSelectionBox(e),this.updateContainer()}listenCellRemoveEvent(e){e.off("removed",this.onCellRemoved,this),e.on("removed",this.onCellRemoved,this)}onCollectionUpdated({added:e,removed:t,options:n}){e.forEach(i=>{this.trigger("cell:selected",{cell:i,options:n}),i.isNode()?this.trigger("node:selected",{cell:i,options:n,node:i}):i.isEdge()&&this.trigger("edge:selected",{cell:i,options:n,edge:i})}),t.forEach(i=>{this.trigger("cell:unselected",{cell:i,options:n}),i.isNode()?this.trigger("node:unselected",{cell:i,options:n,node:i}):i.isEdge()&&this.trigger("edge:unselected",{cell:i,options:n,edge:i})});const o={added:e,removed:t,options:n,selected:this.cells.filter(i=>!!this.graph.getCellById(i.id))};this.trigger("selection:changed",o)}dispose(){this.clean(),this.remove(),this.off()}}V([N.dispose()],D.prototype,"dispose",null);var d;(function(s){const e="widget-selection";s.classNames={root:e,inner:`${e}-inner`,box:`${e}-box`,content:`${e}-content`,rubberband:`${e}-rubberband`,selected:`${e}-selected`},s.documentEvents={mousemove:"adjustSelection",touchmove:"adjustSelection",mouseup:"onMouseUp",touchend:"onMouseUp",touchcancel:"onMouseUp"};function t(n){return n.getAncestors().length}s.depthComparator=t})(d||(d={}));const G=`.x6-widget-selection {
  position: absolute;
  top: 0;
  left: 0;
  display: none;
  width: 0;
  height: 0;
  touch-action: none;
}
.x6-widget-selection-rubberband {
  display: block;
  overflow: visible;
  opacity: 0.3;
}
.x6-widget-selection-selected {
  display: block;
}
.x6-widget-selection-box {
  cursor: move;
}
.x6-widget-selection-inner[data-selection-length='0'],
.x6-widget-selection-inner[data-selection-length='1'] {
  display: none;
}
.x6-widget-selection-content {
  position: absolute;
  top: 100%;
  right: -20px;
  left: -20px;
  margin-top: 30px;
  padding: 6px;
  line-height: 14px;
  text-align: center;
  border-radius: 6px;
}
.x6-widget-selection-content:empty {
  display: none;
}
.x6-widget-selection-rubberband {
  background-color: #3498db;
  border: 2px solid #2980b9;
}
.x6-widget-selection-box {
  box-sizing: content-box !important;
  margin-top: -4px;
  margin-left: -4px;
  padding-right: 4px;
  padding-bottom: 4px;
  border: 2px dashed #feb663;
  box-shadow: 2px 2px 5px #d3d3d3;
}
.x6-widget-selection-inner {
  box-sizing: content-box !important;
  margin-top: -8px;
  margin-left: -8px;
  padding-right: 12px;
  padding-bottom: 12px;
  border: 2px solid #feb663;
  box-shadow: 2px 2px 5px #d3d3d3;
}
.x6-widget-selection-content {
  color: #fff;
  font-size: 10px;
  background-color: #6a6b8a;
}
`;a.prototype.isSelectionEnabled=function(){const s=this.getPlugin("selection");return s?s.isEnabled():!1};a.prototype.enableSelection=function(){const s=this.getPlugin("selection");return s&&s.enable(),this};a.prototype.disableSelection=function(){const s=this.getPlugin("selection");return s&&s.disable(),this};a.prototype.toggleSelection=function(s){const e=this.getPlugin("selection");return e&&e.toggleEnabled(s),this};a.prototype.isMultipleSelection=function(){const s=this.getPlugin("selection");return s?s.isMultipleSelection():!1};a.prototype.enableMultipleSelection=function(){const s=this.getPlugin("selection");return s&&s.enableMultipleSelection(),this};a.prototype.disableMultipleSelection=function(){const s=this.getPlugin("selection");return s&&s.disableMultipleSelection(),this};a.prototype.toggleMultipleSelection=function(s){const e=this.getPlugin("selection");return e&&e.toggleMultipleSelection(s),this};a.prototype.isSelectionMovable=function(){const s=this.getPlugin("selection");return s?s.isSelectionMovable():!1};a.prototype.enableSelectionMovable=function(){const s=this.getPlugin("selection");return s&&s.enableSelectionMovable(),this};a.prototype.disableSelectionMovable=function(){const s=this.getPlugin("selection");return s&&s.disableSelectionMovable(),this};a.prototype.toggleSelectionMovable=function(s){const e=this.getPlugin("selection");return e&&e.toggleSelectionMovable(s),this};a.prototype.isRubberbandEnabled=function(){const s=this.getPlugin("selection");return s?s.isRubberbandEnabled():!1};a.prototype.enableRubberband=function(){const s=this.getPlugin("selection");return s&&s.enableRubberband(),this};a.prototype.disableRubberband=function(){const s=this.getPlugin("selection");return s&&s.disableRubberband(),this};a.prototype.toggleRubberband=function(s){const e=this.getPlugin("selection");return e&&e.toggleRubberband(s),this};a.prototype.isStrictRubberband=function(){const s=this.getPlugin("selection");return s?s.isStrictRubberband():!1};a.prototype.enableStrictRubberband=function(){const s=this.getPlugin("selection");return s&&s.enableStrictRubberband(),this};a.prototype.disableStrictRubberband=function(){const s=this.getPlugin("selection");return s&&s.disableStrictRubberband(),this};a.prototype.toggleStrictRubberband=function(s){const e=this.getPlugin("selection");return e&&e.toggleStrictRubberband(s),this};a.prototype.setRubberbandModifiers=function(s){const e=this.getPlugin("selection");return e&&e.setRubberbandModifiers(s),this};a.prototype.setSelectionFilter=function(s){const e=this.getPlugin("selection");return e&&e.setSelectionFilter(s),this};a.prototype.setSelectionDisplayContent=function(s){const e=this.getPlugin("selection");return e&&e.setSelectionDisplayContent(s),this};a.prototype.isSelectionEmpty=function(){const s=this.getPlugin("selection");return s?s.isEmpty():!0};a.prototype.cleanSelection=function(s){const e=this.getPlugin("selection");return e&&e.clean(s),this};a.prototype.resetSelection=function(s,e){const t=this.getPlugin("selection");return t&&t.reset(s,e),this};a.prototype.getSelectedCells=function(){const s=this.getPlugin("selection");return s?s.getSelectedCells():[]};a.prototype.getSelectedCellCount=function(){const s=this.getPlugin("selection");return s?s.getSelectedCellCount():0};a.prototype.isSelected=function(s){const e=this.getPlugin("selection");return e?e.isSelected(s):!1};a.prototype.select=function(s,e){const t=this.getPlugin("selection");return t&&t.select(s,e),this};a.prototype.unselect=function(s,e){const t=this.getPlugin("selection");return t&&t.unselect(s,e),this};var L=globalThis&&globalThis.__decorate||function(s,e,t,n){var o=arguments.length,i=o<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(s,e,t,n);else for(var l=s.length-1;l>=0;l--)(r=s[l])&&(i=(o<3?r(i):o>3?r(e,t,i):r(e,t))||i);return o>3&&i&&Object.defineProperty(e,t,i),i};class x extends P{get rubberbandDisabled(){return this.options.enabled!==!0||this.options.rubberband!==!0}get disabled(){return this.options.enabled!==!0}get length(){return this.selectionImpl.length}get cells(){return this.selectionImpl.cells}constructor(e={}){super(),this.name="selection",this.movedMap=new WeakMap,this.unselectMap=new WeakMap,this.options=Object.assign(Object.assign({enabled:!0},x.defaultOptions),e),j(this.name,G)}init(e){this.graph=e,this.selectionImpl=new D(Object.assign(Object.assign({},this.options),{graph:e})),this.setup(),this.startListening()}isEnabled(){return!this.disabled}enable(){this.disabled&&(this.options.enabled=!0)}disable(){this.disabled||(this.options.enabled=!1)}toggleEnabled(e){return e!=null?e!==this.isEnabled()&&(e?this.enable():this.disable()):this.isEnabled()?this.disable():this.enable(),this}isMultipleSelection(){return this.isMultiple()}enableMultipleSelection(){return this.enableMultiple(),this}disableMultipleSelection(){return this.disableMultiple(),this}toggleMultipleSelection(e){return e!=null?e!==this.isMultipleSelection()&&(e?this.enableMultipleSelection():this.disableMultipleSelection()):this.isMultipleSelection()?this.disableMultipleSelection():this.enableMultipleSelection(),this}isSelectionMovable(){return this.options.movable!==!1}enableSelectionMovable(){return this.selectionImpl.options.movable=!0,this}disableSelectionMovable(){return this.selectionImpl.options.movable=!1,this}toggleSelectionMovable(e){return e!=null?e!==this.isSelectionMovable()&&(e?this.enableSelectionMovable():this.disableSelectionMovable()):this.isSelectionMovable()?this.disableSelectionMovable():this.enableSelectionMovable(),this}isRubberbandEnabled(){return!this.rubberbandDisabled}enableRubberband(){return this.rubberbandDisabled&&(this.options.rubberband=!0),this}disableRubberband(){return this.rubberbandDisabled||(this.options.rubberband=!1),this}toggleRubberband(e){return e!=null?e!==this.isRubberbandEnabled()&&(e?this.enableRubberband():this.disableRubberband()):this.isRubberbandEnabled()?this.disableRubberband():this.enableRubberband(),this}isStrictRubberband(){return this.selectionImpl.options.strict===!0}enableStrictRubberband(){return this.selectionImpl.options.strict=!0,this}disableStrictRubberband(){return this.selectionImpl.options.strict=!1,this}toggleStrictRubberband(e){return e!=null?e!==this.isStrictRubberband()&&(e?this.enableStrictRubberband():this.disableStrictRubberband()):this.isStrictRubberband()?this.disableStrictRubberband():this.enableStrictRubberband(),this}setRubberbandModifiers(e){this.setModifiers(e)}setSelectionFilter(e){return this.setFilter(e),this}setSelectionDisplayContent(e){return this.setContent(e),this}isEmpty(){return this.length<=0}clean(e={}){return this.selectionImpl.clean(e),this}reset(e,t={}){return this.selectionImpl.reset(e?this.getCells(e):[],t),this}getSelectedCells(){return this.cells}getSelectedCellCount(){return this.length}isSelected(e){return this.selectionImpl.isSelected(e)}select(e,t={}){const n=this.getCells(e);return n.length&&(this.isMultiple()?this.selectionImpl.select(n,t):this.reset(n.slice(0,1),t)),this}unselect(e,t={}){return this.selectionImpl.unselect(this.getCells(e),t),this}setup(){this.selectionImpl.on("*",(e,t)=>{this.trigger(e,t),this.graph.trigger(e,t)})}startListening(){this.graph.on("blank:mousedown",this.onBlankMouseDown,this),this.graph.on("blank:click",this.onBlankClick,this),this.graph.on("cell:mousemove",this.onCellMouseMove,this),this.graph.on("cell:mouseup",this.onCellMouseUp,this),this.selectionImpl.on("box:mousedown",this.onBoxMouseDown,this)}stopListening(){this.graph.off("blank:mousedown",this.onBlankMouseDown,this),this.graph.off("blank:click",this.onBlankClick,this),this.graph.off("cell:mousemove",this.onCellMouseMove,this),this.graph.off("cell:mouseup",this.onCellMouseUp,this),this.selectionImpl.off("box:mousedown",this.onBoxMouseDown,this)}onBlankMouseDown({e}){if(!this.allowBlankMouseDown(e))return;const t=this.graph.panning.allowPanning(e,!0),n=this.graph.getPlugin("scroller"),o=n&&n.allowPanning(e,!0);(this.allowRubberband(e,!0)||this.allowRubberband(e)&&!o&&!t)&&this.startRubberband(e)}allowBlankMouseDown(e){const t=this.options.eventTypes;return(t==null?void 0:t.includes("leftMouseDown"))&&e.button===0||(t==null?void 0:t.includes("mouseWheelDown"))&&e.button===1}onBlankClick(){this.clean()}allowRubberband(e,t){return!this.rubberbandDisabled&&R.isMatch(e,this.options.modifiers,t)}allowMultipleSelection(e){return this.isMultiple()&&R.isMatch(e,this.options.multipleSelectionModifiers)}onCellMouseMove({cell:e}){this.movedMap.set(e,!0)}onCellMouseUp({e,cell:t}){const n=this.options;let o=this.disabled;!o&&this.movedMap.has(t)&&(o=n.selectCellOnMoved===!1,o||(o=n.selectNodeOnMoved===!1&&t.isNode()),o||(o=n.selectEdgeOnMoved===!1&&t.isEdge())),o||(this.allowMultipleSelection(e)?this.unselectMap.has(t)?this.unselectMap.delete(t):this.isSelected(t)?this.unselect(t):this.select(t):this.reset(t)),this.movedMap.delete(t)}onBoxMouseDown({e,cell:t}){this.disabled||this.allowMultipleSelection(e)&&(this.unselect(t),this.unselectMap.set(t,!0))}getCells(e){return(Array.isArray(e)?e:[e]).map(t=>typeof t=="string"?this.graph.getCellById(t):t).filter(t=>t!=null)}startRubberband(e){return this.rubberbandDisabled||this.selectionImpl.startSelecting(e),this}isMultiple(){return this.options.multiple!==!1}enableMultiple(){return this.options.multiple=!0,this}disableMultiple(){return this.options.multiple=!1,this}setModifiers(e){return this.options.modifiers=e,this}setContent(e){return this.selectionImpl.setContent(e),this}setFilter(e){return this.selectionImpl.setFilter(e),this}dispose(){this.stopListening(),this.off(),this.selectionImpl.dispose(),$(this.name)}}L([P.dispose()],x.prototype,"dispose",null);(function(s){s.defaultOptions={rubberband:!1,rubberNode:!0,rubberEdge:!1,pointerEvents:"auto",multiple:!0,multipleSelectionModifiers:["ctrl","meta"],movable:!0,strict:!1,selectCellOnMoved:!1,selectNodeOnMoved:!1,selectEdgeOnMoved:!1,following:!0,content:null,eventTypes:["leftMouseDown","mouseWheelDown"]}})(x||(x={}));export{x as S,B as o};
